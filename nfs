#!/usr/bin/env python
#-*- coding:utf-8 -*-
'''
nfs 网络文件系统 network file system
    功能是通过网络让不同的及其系统之间可以彼此共享文件或目录，nfs客户端（一般为应用服务器，如web）可以通过挂载的方式将nfs服务器端共享的数据文件目录挂载到nfs客户端本地系统的某一挂载点下，从本地nfs客户端的机器看来，nfs服务器共享的目录就好像是自己的磁盘分区或目录一样

图7，图8

    nfs一般用来存储共享视频，图片，附件等静态资源文件（对于用户上传的文件都放到nfs里面），是当前互联网系统架构中常用的服务之一，特别是中小公司应用频率很高,大公司或门户用MFS,GFS,FASTFS分布式系统,淘宝也在用nfs,nfs性能不是特别高
    中小企业一般不会买存储，大公司业务发展快，可能会临时买存储顶一下，并发继续加大可能存储扩展就相对费劲，价格成几何级数增加，淘宝就替换了很多硬件设备集群软件，用lvs+haproxy替换了netscaler,用fastfs,tfs替换了netapp,emc存储

nfs 使用端口，协议传输数据
    nfs的端口是随机选择的，不固定
    nfs客户端通过rpc（远程过程调用）协议/服务 来实现传输数据
RPC协议/服务
    NFS支持的功能较多，不同功能利用不同程序启动，程序多端口就多，所有NFS端口才无法固定，随机启用小于1024的端口来做数据传输使用，客户端和服务端链接就出现困扰了，不知道端口是什么
    解决上述问题就利用RPC,RPC功能就是记录每个NFS功能和对应的端口号，当客户端请求服务端时候，把对应信息发给客户端，让客户端可以连接到正确的端口上，RPC类似服务端和客户端之间的中介
RPC如何知道NFS的端口
    NFS服务端启动时会随机去用数个端口，并主动向RPC服务注册去用的端口信息，这杨RPC服务就知道了每个端口对应的NFS功能，然后RPC服务使用固定的端口111来监听NFS客户端的请求，并将正确的NFS端口应答给NFS客户端，这样，就能进行数据传输了  图9

强调：
    启动NFS server之前，首先要启动RPC服务（centos5.8下为portmap服务，centos6.4下为rpcbind服务），否则NFS server 就无法想RPC注册。另外RPC服务重启，原来已经注册好的端口数据就会丢失，因此，此时RPC管理的NFS程序也需要重新启动以重新向RPC注册，特别注意，一般修改NFS配置后，是不需要重启NFS的，直接在命令行执行/etc/init.d/nfs reload或 exportfs -rv 即可使修改的 /etc/exports 生效

安装部署NFS
    环境准备

客户端 需要RPC服务进程，不需要NFS服务进程
服务端 需要RPC服务进程，需要NFS服务进程


        
